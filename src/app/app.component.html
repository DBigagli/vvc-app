<div id="vvc-container" [ngClass]="{'fullsize':widgetState.fullScreen, 'nochat':!widgetState.chatVisibility && widgetState.fullScreen}">

  <vvc-fullscreen id="vvc-full-enabled"
                  *ngIf="widgetState?.fullScreen"
                  [state]="widgetState"
                  (hangup)="setNormalScreen();hangup()"
                  (addvideo)="addLocalVideo()"
                  (remvideo)="removeLocalVideo()"
                  (minimize)="setNormalScreen()"
                  (showchat)="setChatVisibility($event)"
                  (mute)="setMute($event)"></vvc-fullscreen>

  <vvc-queue id="vvc-queue"
             *ngIf="widgetState?.loading"
             [type]="type"></vvc-queue>

  <div id="vvc-widget-wrap"
       *ngIf="!widgetState?.loading && !widgetState?.dataCollectionPanel">

    <vvc-topbar id="vvc-top-bar"
                [ngClass]="{'expanded':widgetState?.topBarExpanded}"
                [state]="widgetState"
                (close)="showCloseModal()"></vvc-topbar>

    <vvc-media-tools id="vvc-media-tools"
                     *ngIf="widgetState?.voice && !widgetState.fullScreen"
                     [state]="widgetState"
                     (hangup)="hangup()"
                     (addvideo)="addLocalVideo()"
                     (remvideo)="removeLocalVideo()"
                     (maximize)="setFullScreen()"
                     (mute)="setMute($event)"></vvc-media-tools>

    <div id="vvc-messages" angular2-auto-scroll>
      <div *ngFor="let m of messages" [ngSwitch]="m.type">
        <vvc-chat-message *ngSwitchCase="'chat'" [message]="m"></vvc-chat-message>
        <vvc-incoming-message *ngSwitchCase="'incoming-request'"
                              [message]="m"
                              (rejectOffer)="denyIncomingRequest()"
                              (acceptOffer)="acceptIncomingRequest($event)"></vvc-incoming-message>
      </div>
    </div>

    <vvc-chat-box id="vvc-chat-area"
                  (upload)="sendAttachment($event)"
                  (message)="sendChatMessage($event)"></vvc-chat-box>

  </div>

</div>