language: node_js
node_js:
- '12'
branches:
  only:
  - master
cache:
- npm
- directories:
  - interaction/app/default/node_modules
  - interaction/lib/core/node_modules
  - interaction/lib/layout/node_modules
  - node_modules
env:
  global:
  - secure: WyMvwa03+SInh814yBjTlCY//XgZIqkhH3Tne4/GrvH4h0h8audicz2zJqAYwKqPD8gBvtcio0Sx6MQZH5WHthpmT0VMG4SnasR2dKzxqcnOYehHrLjUN+3D0/LsSYbEJzJJkFWuffUKnUmKjHMBAYxWR7l72dyI9ZaqNKXL2s2YXuqGTbGdtOyh+VkcpQWHUKRqHyFZdXpaHWPc90aN02a/uBRA0NkF/oqRZAv2QijX+LcqN9Fd/48xLskzylVhctbofhf2ft4mkR0xJuLrd/wQyNJ/cvGefpv2AwIQ+zvyfBfSc4RcQymJyEW0nkizuIej+vBBosq1gZUaO9VDVsr7wsd/qIBznn48tJ9/L2IoqUz3IWwC0UA/fQNLJyxw5s/EdeyaAIm8tlc/a5X/irMhTI50VRzj0syKL/dahsEZfX9NqVydAWZ+/oxsonbrSfTV1UZL68bFzrfvzT5lZZXLN9QKB87DDPkFjpKyoiFobSXsWJTrrm2pr1qqXZlCrd5gD50FBEWQHeL+OW1GVfhbLR5aDwRdlSrLvER9JFIvg4az3j1sRGbyNMxR73fKalY8m+bdcBM0o4wGJzxh4GBTBOyi6P+LAh0UdCIVhfkACesZFL1xGufwXDtsn7GvjPC2Ow8DE7xHkpsOXZuS0N/E0ocLW27lfApBeOhBRWo=
  - secure: t+mUJfHmKyJyqmNUO2cRxjazo+cp2Ev7OKP/otPXGHho38sKUEtWjSzW0CR+63LqVyS9EnPmlWpccxazHF0/P/4K0jyKQ1MfTv+dH5mdmtdm7mPUQuS/koc5XwJ/EEX4/cI6OCZoPtdPyA/UEHIhgeK+LC4ILP/BaOZ+I4psYF/PIHgvQx0Xv0RpUR9jYZ8CX5GwXJdhX8gKSn6AkaS8IfYel2b4uXwlnQmCEf2OIg6I31GiKy/shSUvJhI1v/vTZEgHfHjAHRThpuqdUSzPivGx8O5IDMEWHlTflzOI3Rv2Rrh7dIxe2yX0SIPZknDtE+7+lxWkCJucIWy3kp3hm4X9AfrmAsMPZHs98IQxlL4P7tr2DWe527BDvTcE9W40AsVUezK8Wp9CkjXe143LEqQVzQG2MwJq47iOm9PDL8RwHX421vdYyOSKrU45JAb5+1WnjHSOIodMSvU0amN/9j/qyY9kSxi+nzC2gnppfIOjjZ5Ck8hTfaSRqw0D43vxxd1+BvsJ+rC+vq1wiyKxsEV7EYvMInCIM8GF9AQXjGmur+9SvnKaL1fhZc/vxrqI0NwBOOla/T5XE5hf6WrQKophCkrSS1MlZ49Two+Vk/bLmuQFbtPDlgr2koOQszpgvA8bFv++EwW7oanQyk4Tq6QzOBDxrwYo10jdJYDssQ8=
  - GITHUB_EMAIL: dev@vivocha.com
  - GITHUB_USER: Travis CI
before_install:
- npm config set //registry.npmjs.org/:_authToken=$NPM_TOKEN
before_script:
- lerna bootstrap --hoist --include-filtered-dependencies
- ls -l interaction/lib/core/dist/
- ls -l interaction/lib/layout/dist/
deploy:
- provider: script
  skip_cleanup: true
  script: lerna publish from-package -y --contents dist
  on:
    branch: master
after_script:
- git remote add -f app https://${GH_TOKEN}@github.com/vivocha/vvc-app.git
- git subtree push --prefix interaction/app/default app master
- git push app --tags